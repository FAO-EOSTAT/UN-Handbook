<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Gilberto Camara, Lorenzo de Simone, Ronald Jansen">
<title>UN Handbook on Remote Sensing for Agricultural Statistics - 29&nbsp; An Automated Flood Detection Algorithm for Post-Disaster Assessment</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ad_governance.html" rel="next">
<link href="./ad_disaster_response.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./additional.html">Additional Topics</a></li><li class="breadcrumb-item"><a href="./ad_china_floods.html"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">An Automated Flood Detection Algorithm for Post-Disaster Assessment</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">UN Handbook on Remote Sensing for Agricultural Statistics</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/FAO-EOSTAT/UN-Handbook" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Welcome</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./howto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">How to use this handbook</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./th_remote_sensing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Remote sensing images: optical, SAR</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./th_data_sources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Earth observation big data sources</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./th_data_cubes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Earth observation data cubes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./th_lucc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Land cover and crop classification schemas</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./th_quality_control.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Quality control of training sets for agricultural statistics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./th_machine_learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Machine learning algorithms for image time series</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./th_uncertainty.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Spatial map uncertainty estimation and active learning in crop classification</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./th_validation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Map validation and use of maps for area estimation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./th_design_frames.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Remote Sensing in the Design of Sampling Frames</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./th_parcel_extraction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Automatic Extraction of Parcels</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./crop_type_mapping.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Use Cases in Crop Type Mapping</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ct_poland.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Crop monitoring with SAR images in Poland</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ct_mexico.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Crop classification in Mexico</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ct_senegal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Multi-seasonal crop mapping in Senegal</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ct_zimbabwe.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Crop classification in Zimbabwe</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ct_chile.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Crop classification and land use mapping in Chile</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ct_digital_earth_africa.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Agricultural Mapping with Digital Earth Africa</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./crop_yield_estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Crop yield estimation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cy_finland.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Early-season crop yield mapping in Finland</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cy_indonesia.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Mapping crop phenology in Indonesia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cy_poland.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Yield forecasting in Poland</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cy_colombia.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Rice Phenology in Colombia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cy_china.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Crop type classification and crop yield estimation in China</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./additional.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Additional Topics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ad_geoglam.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Extraction of crop statistics from crop type and crop yield maps</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ad_world_cereal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">WorldCereal - A Global Effort for Crop Mapping</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ad_uav_applications.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">UAV use in Agricultural Statistics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ad_disaster_response.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Remote Sensing for Agricultural Disaster Response</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ad_china_floods.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">An Automated Flood Detection Algorithm for Post-Disaster Assessment</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ad_governance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Data Governance for Agricultural Statistics</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">29.1</span> Introduction</a>
  <ul class="collapse">
<li><a href="#experimental-area-and-data" id="toc-experimental-area-and-data" class="nav-link" data-scroll-target="#experimental-area-and-data"><span class="header-section-number">29.1.1</span> Experimental Area and Data</a></li>
  </ul>
</li>
  <li>
<a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods"><span class="header-section-number">29.2</span> Methods</a>
  <ul class="collapse">
<li><a href="#feature-calculation" id="toc-feature-calculation" class="nav-link" data-scroll-target="#feature-calculation"><span class="header-section-number">29.2.1</span> Feature Calculation</a></li>
  <li><a href="#calculation-of-anomaly-scores-for-feature-change-rate" id="toc-calculation-of-anomaly-scores-for-feature-change-rate" class="nav-link" data-scroll-target="#calculation-of-anomaly-scores-for-feature-change-rate"><span class="header-section-number">29.2.2</span> Calculation of Anomaly Scores for Feature Change Rate</a></li>
  <li><a href="#accuracy-evaluation" id="toc-accuracy-evaluation" class="nav-link" data-scroll-target="#accuracy-evaluation"><span class="header-section-number">29.2.3</span> Accuracy Evaluation</a></li>
  </ul>
</li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results"><span class="header-section-number">29.3</span> Results</a></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion"><span class="header-section-number">29.4</span> Discussion</a></li>
  <li><a href="#conclusions" id="toc-conclusions" class="nav-link" data-scroll-target="#conclusions"><span class="header-section-number">29.5</span> Conclusions</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/FAO-EOSTAT/UN-Handbook/edit/quarto/ad_china_floods.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/FAO-EOSTAT/UN-Handbook/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">29</span>&nbsp; <span class="chapter-title">An Automated Flood Detection Algorithm for Post-Disaster Assessment</span>
</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Xiufang Zhu, Rui Guo </p>
          </div>
  </div>
    
  
    
  </div>
  

</header><section id="introduction" class="level2" data-number="29.1"><h2 data-number="29.1" class="anchored" data-anchor-id="introduction">
<span class="header-section-number">29.1</span> Introduction</h2>
<p>Flooding is one of the most destructive natural disasters globally. Efficient flood detection and management are essential to reduce the damages and mitigate the impacts. Remote sensing has become a vital tool in flood disaster monitoring, offering rapid, large-scale, and timely data collection. This section introduces an integrated algorithm (TSM-SAM) that combines the Isolation Forest algorithm, 16 Threshold Segmentation Methods (TSMs), and Segment Anything Model (SAM) to achieve automated flood detection. TSM-SAM does not require manual intervention and has a fully automated and unified processing flow, which has enormous potential application value in real-time monitoring and evaluation of flood disasters.</p>
<section id="experimental-area-and-data" class="level3" data-number="29.1.1"><h3 data-number="29.1.1" class="anchored" data-anchor-id="experimental-area-and-data">
<span class="header-section-number">29.1.1</span> Experimental Area and Data</h3>
<p>To validate the method’s applicability and robustness across different geographical environments, three typical flood cases from distinct watersheds in China were selected for algorithm testing (<a href="#fig-floods-area">Figure&nbsp;<span>29.1</span></a>). The chosen watersheds exhibit significant differences in topography and geographic distribution, including the Dongting Lake watershed in Hunan Province, the Wei River watershed in Henan Province, and the Huai River watershed in Anhui Province. The details of each case are as follows:</p>
<ol type="1">
<li><p>Case 1: Dongting Lake watershed, a major rice-producing basin in central China, contributing 12% of national rice output): In July 2024, severe flooding struck Yueyang City in Hunan Province due to continuous heavy rainfall and Typhoon “Gemi”. The flood lasted three days, submerging over 45 km² of farmland with an average water depth of approximately 5 meters.</p></li>
<li><p>Case 2: Wei River watershed, a major grain production base in central China renowned for its winter wheat-summer maize double cropping system. In July 2021, extreme rainfall in Weihui City, Henan Province, triggered a catastrophic flood in the Wei River watershed. The torrential rain caused rapid water level rise, resulting in urban inundation with a peak depth of 2 meters.</p></li>
<li><p>Case 3: Huai River watershed, a key winter wheat and soybean production area in eastern China. In July 2020, heavy rainfall led to a major flood in Huainan City, Anhui Province, within the Huai River watershed. The flood persisted for several weeks. Farmland and infrastructure sustained damage.</p></li>
</ol>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-floods-area" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="./images/ad_china_floods/image1.jpeg" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;29.1: Distribution map of crop flooding experimental areas.</figcaption></figure>
</div>
</div>
</div>
<p>This method utilizes Sentinel-1 Synthetic Aperture Rada (SAR) data. The Sentinel-1 data preprocessing follows the framework summarized by Mullissa et al.&nbsp;(2021) for SAR backscatter data preprocessing in GEE, including border noise removal, speckle filtering, and radiometric terrain normalization. Additionally, the land use and land cover dataset from the Dynamic World database released by Google (Brown et al., 2022) were utilized. Cropland areas were extracted from this dataset to create a cropland mask (0 for non-cropland, 1 for cropland).</p>
<div id="tbl-floods-area" class="anchored">
<table class="table">
<caption>Table&nbsp;29.1: Study area and data</caption>
<colgroup>
<col style="width: 54%">
<col style="width: 43%">
</colgroup>
<thead><tr class="header">
<th>Study Area</th>
<th>Data Time</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Case 1: Yueyang City, Dongting Lake watershed, Hunan Province</td>
<td>
<p>2024-06-22 (before flooding)</p>
<p>2024-07-16 (after flooding)</p>
</td>
</tr>
<tr class="even">
<td>Case 2: Weihui City, Wei River watershed, Henan Province</td>
<td>
<p>2021-07-15 (before flooding)</p>
<p>2021-07-27 (after flooding)</p>
</td>
</tr>
<tr class="odd">
<td>Case 3: Huainan City, Huai River watershed, Anhui Province</td>
<td>
<p>2020-07-03 (before flooding)</p>
<p>2020-07-27 (after flooding)</p>
</td>
</tr>
</tbody>
</table>
</div>
</section></section><section id="methods" class="level2" data-number="29.2"><h2 data-number="29.2" class="anchored" data-anchor-id="methods">
<span class="header-section-number">29.2</span> Methods</h2>
<p>The technical workflow of TSM-SAM. It includes the following key steps: (1) calculate feature indices of images obtained before and after flood; (2) calculate the change rate of the above feature indices before and after the occurrence of flood; (3) use the feature change rate image as input to calculate the normalized anomaly score for each pixel and generate an anomaly score map by the Isolation Forest algorithm; (4) use multiple unsupervised TSMs to automatically segment the anomaly score map and obtain the initial flood extent map (R1); (5) automatically select prompt points based on R1 and apply the SAM model to classify flood and non-flood areas, producing the flood extent map R2; (6) integrate R1 and R2 according to the predefined rules to generate the final flood extent map (R3).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-floods-method" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="./images/ad_china_floods/image2.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;29.2: Technical workflow of the post-flooding detection method.</figcaption></figure>
</div>
</div>
</div>
<section id="feature-calculation" class="level3" data-number="29.2.1"><h3 data-number="29.2.1" class="anchored" data-anchor-id="feature-calculation">
<span class="header-section-number">29.2.1</span> Feature Calculation</h3>
<p>This method used Sentinel-1 SAR images, applying speckle filtering to reduce noise and calculating several indices to further highlight flooding information. Specifically, using the VV and VH polarization bands from the Sentinel-1 data, the ratio of VV to VH bands was calculated to enhance the contrast between different polarization channels (Amitrano et al., 2024; DeVries et al., 2020); the Sentinel-1 Dual-Polarized Water Index (SDWI) (Ta et al., 2024) was computed to effectively distinguish water bodies from other land cover types, thereby enhancing crop flood detection capability. The specific calculation equations are as follows:</p>
<p><span class="math display">\[\text{Ratio} = \frac{\text{VV}}{\text{VH}}\]</span> (1)</p>
<p><span class="math display">\[\text{SDWI} = ln\left( 10 \times \text{VV} \times \text{VH} \right)\]</span> (2)</p>
<p>The feature change rate between the pre-flood and post-flood images was calculated for each feature (Equation 3). This metric quantifies the extent of pixel-level changes, emphasizes flood-related variations, and suppresses interference from environmental factors.</p>
<p><span class="math display">\[\text{CR} = \frac{I_{\text{after}} - I_{\text{before}}}{\left| I_{\text{before}} \right|}\]</span> (3)</p>
<p>Where <span class="math inline">\(I_{\text{after}}\)</span> and <span class="math inline">\(I_{\text{before}}\)</span> represent value of a certain feature index of a pixel before and after the flood, respectively. The features involved in the computation specifically include VV, VH, Ratio, and SDWI.</p>
</section><section id="calculation-of-anomaly-scores-for-feature-change-rate" class="level3" data-number="29.2.2"><h3 data-number="29.2.2" class="anchored" data-anchor-id="calculation-of-anomaly-scores-for-feature-change-rate">
<span class="header-section-number">29.2.2</span> Calculation of Anomaly Scores for Feature Change Rate</h3>
<p>Using the Isolation Forest algorithm (Liu et.al., 2008) from the Scikit-learn toolkit, each pixel in the feature change rate image was treated as a sample, and the normalized anomaly score for each pixel was calculated. The normalized anomaly score is expressed numerically in the range of [-1, 1]. A score closer to 1 indicates a lower anomaly degree, implying a lower probability of being a flooded pixel, while a score closer to -1 indicates a higher anomaly degree, implying a higher probability of being a flooded pixel.</p>
<p>The Threshold Segmentation Method (TSM) was applied to the anomaly score map to classify as flooded (1) or non-flooded (0). A comprehensive set of 16 TSMs was employed for this segmentation, including Otsu's (Otsu et al., 1975), Intermodes (Prewitt &amp; Mendelsohn, 1966), Mean, Median, Concavity (Rosenfeld &amp; De La Torre, 1983), Minimum, Triangle (Zack et al., 1977), Percentile (Dhal et al., 2020), Huang's (Huang &amp; Wang, 1995), Intermeans (Ridler et al., 1978) and ISODATA (Ball, 1965), MaxEntropy (Kapur et al., 1985)、Li's (Li &amp; Lee, 1993)、Kittler's (Kittler &amp; Illingworth, 1986)、Tsai's (Tsai, 1985) and Zhen Zhou's method (Wang, 2016). For each TSM, a binary segmentation map was generated. These binary maps were then combined to create a new image. In this new image, when the value of a pixel was greater than or equal to 15 (i.e., at least 15 algorithms classified the pixel as flooded), the pixel was labeled as a flooded pixel. The final flood extent derived from the TSM-based approach was denoted as R1.</p>
<p>The Segment Anything Model (SAM) is a deep learning-based segmentation model(Ke et al., 2023). The Isolation Forest anomaly scores were first transformed into three-channel pseudo-RGB data to ensure compatibility with SAM's input requirements. Prompt points were derived from the threshold segmentation result (R1). The processed pseudo-RGB data along with the selected prompt points were then fed into the SAM model for flood area detection. The prompt generation process was as follows: First, setting the total number of prompt points to 40. To ensure a balance between positive and negative samples, 15 flooded (1) pixels and 15 non-flooded (0) pixels were randomly selected from R1 as positive and negative prompt points. The remaining 10 prompt points were allocated proportionally based on the flood pixel ratio <span class="math inline">\(r\)</span> in R1, with 10×r points assigned to flooded areas and 10×(1-r) points to non-flooded areas. Specifically, let <span class="math inline">\(\text{Npos}\)</span> be the number of flooded pixels and <span class="math inline">\(\text{Nneg}\)</span> the number of non-flooded pixels in R1. The ratio <span class="math inline">\(r\)</span> was calculated as Equation 4. To enhance result stability, the SAM segmentation was independently executed 20 times with a majority voting mechanism applied. Pixels consistently identified as flooded areas in ≥18 detection instances were classified as flooded zones (1). The final flood extent derived from the SAM-based approach was denoted as R2.</p>
<p><span class="math display">\[r = \frac{\text{Npos}}{\text{Npos} + \text{Nneg}}\]</span> (4)</p>
<p>The final TSM-SAM flood extent detection result (R3) was generated through an integrated vector-based analysis of both the TSM-derived result (R1) and SAM-derived result (R2). The methodology involved: (1) converting all connected pixel regions in R1 and R2 into individual vector polygons; (2) performing spatial overlay analysis between the two vector datasets; (3) applying a conservative consensus rule where only areas identified as flooded in both R1 and R2 were retained, specifically preserving the R1 vector boundaries in these overlapping zones; (4) excluding all non-overlapping flood detections from either dataset. This fusion approach leverages the complementary strengths of both methods.</p>
</section><section id="accuracy-evaluation" class="level3" data-number="29.2.3"><h3 data-number="29.2.3" class="anchored" data-anchor-id="accuracy-evaluation">
<span class="header-section-number">29.2.3</span> Accuracy Evaluation</h3>
<p>Flood detection accuracy was evaluated using indicators such as Overall Accuracy (OA), Precision (P), Recall (R), and F1-Score (F1). These metrics were compared against manually digitized flood maps for validation.</p>
<p><span class="math display">\[\text{OA} = \frac{\text{TP} + \text{TN}}{\text{TP} + \text{TN} + \text{FP} + \text{FN}}\]</span> (5) <span class="math display">\[\text{P} = \frac{\text{TP}}{\text{TP} + \text{FP}}\]</span> (6) <span class="math display">\[\text{R} = \frac{\text{TP}}{\text{TP} + \text{FN}}\]</span> (7) <span class="math display">\[F1 = 2 \times \frac{\text{P}\text{×}\text{R}}{\text{P} + \text{R}}\]</span> (8)</p>
<p>Where TP (True Positives) refers to the number of pixels correctly classified as flooded, TN (True Negatives) refers to the number of pixels correctly classified as non-flooded, FN (False Negatives) refers to the pixels incorrectly classified as non-flooded but are actually flooded, and FP (False Positives) refers to the pixels incorrectly classified as flooded but are actually non-flooded.</p>
</section></section><section id="results" class="level2" data-number="29.3"><h2 data-number="29.3" class="anchored" data-anchor-id="results">
<span class="header-section-number">29.3</span> Results</h2>
<p>The proposed methodology was validated using multi-temporal Sentinel-1 SAR data across three characteristic flood events: the 2024 Dongting Lake (Hunan) flood, 2021 Wei River (Henan) flood, and 2020 Huai River (Anhui) flood. Three algorithms—TSM, SAM, and TSM-SAM—were evaluated and compared for their effectiveness in detecting flood extent.</p>
<p><a href="#fig-floods-pre-post">Figure&nbsp;<span>29.3</span></a> illustrates pre- and post-flood images, feature change rate maps, and normalized anomaly score maps derived from the Isolation Forest algorithm. Flooded areas are clearly identified with low anomaly scores (near -1), while non-flooded areas show higher scores (near 1), indicating strong correspondence between anomaly scores and actual flood-affected areas.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-floods-pre-post" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="./images/ad_china_floods/image3.jpeg" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;29.3: Pre- and post-flooding images, feature change rate maps and normalized isolation forest anomaly score maps.</figcaption></figure>
</div>
</div>
</div>
<p><a href="#fig-floods-comparison">Figure&nbsp;<span>29.4</span></a> shows flood extent maps generated by the TSM, SAM, and TSM-SAM methods. TSM captures boundary details well but includes noisy, scattered pixels. SAM produces smoother and more cohesive results but lacks detail at the edges. TSM-SAM combines the strengths of both, yielding more complete and accurate results across all three cases.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-floods-comparison" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="./images/ad_china_floods/image4.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;29.4: Flood extent map: Visual interpretation vs.&nbsp;SAM, TSM, and TSM-SAM algorithms.</figcaption></figure>
</div>
</div>
</div>
<p><a href="#fig-floods-accuracy">Figure&nbsp;<span>29.5</span></a> presents the flood detection accuracy results for the TSM, SAM, and TSM-SAM methods across three cases. TSM-SAM consistently outperforms the other two approaches, achieving the highest overall accuracy (OA) and F1 scores in each scenario. Specifically, the method achieves an average OA of 0.9720 and F1 score of 0.8870, demonstrating strong reliability in both precision and recall. The best performance is observed in the Huai River case, with OA reaching 0.9779 and F1 score of 0.9022.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-floods-accuracy" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="./images/ad_china_floods/image5.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;29.5: Accuracy of flooding detection using SAM, TSM, and TSM-SAM algorithms.</figcaption></figure>
</div>
</div>
</div>
<p><a href="#fig-floods-box-plots">Figure&nbsp;<span>29.6</span></a> shows box plots illustrating the distribution of accuracy metrics—OA, precision, recall, and F1—for all three methods. Compared to TSM and SAM, the TSM-SAM method exhibits the most concentrated and stable metric distribution, indicating greater robustness and consistency in flood extent detection across varied environments.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-floods-box-plots" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="./images/ad_china_floods/image6.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;29.6: Accuracy boxplots for flooding detection by SAM, TSM, and TSM-SAM.</figcaption></figure>
</div>
</div>
</div>
<p><a href="#fig-floods-tsm-accuracy">Figure&nbsp;<span>29.7</span></a> compares the accuracy of the proposed TSM with 16 other threshold segmentation methods. TSM outperforms the average of individual methods in all regions and demonstrated more stable performance across basins.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-floods-tsm-accuracy" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="./images/ad_china_floods/image7.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;29.7: Accuracy of TSM vs.&nbsp;16 threshold segmentation methods.</figcaption></figure>
</div>
</div>
</div>
</section><section id="discussion" class="level2" data-number="29.4"><h2 data-number="29.4" class="anchored" data-anchor-id="discussion">
<span class="header-section-number">29.4</span> Discussion</h2>
<p>The TSM-SAM method uses anomaly scores generated by Isolation Forest preprocessing as input, offering the following advantages. First, abnormal scores effectively amplify flood signals and suppress background noise through unsupervised learning, which is beneficial for improving flood detection accuracy. <a href="#fig-floods-anomaly">Figure&nbsp;<span>29.8</span></a> shows that models using Isolation Forest anomaly scores as input outperformed those using raw VV, VH, and SDWI data. Improvements were observed across most metrics, especially in the Huai River basin for the TSM model.</p>
<p>Second, it can unify data from different sensors (SAR/optical/thermal infrared) into the same feature space, facilitating multi-source data integration. In operational disaster monitoring, diverse remote sensing sensors exhibit inherent disparities in spectral features, spatial resolutions, and imaging physics. The Isolation Forest algorithm serves as a unified feature extractor by converting such heterogeneous data into standardized anomaly score maps. This transformation enhances the model's adaptability to different scenes and data sources.</p>
<p>Third, the single-channel anomaly scores can be losslessly converted into three-channel pseudo-RGB data, enabling direct input into standard CNN architectures (e.g., SAM's Vision Transformer encoder). For example, in this study, the single channel data of anomaly score map was replicated to form three channel data, a format readily processed by deep learning models. The approach maintains full data fidelity while meeting architectural input requirements. Furthermore, the method demonstrates remarkable flexibility with multi-source data. For example, when employing diverse inputs such as SAR, optical, and thermal infrared images, each modality is first independently processed to generate corresponding anomaly score maps. These maps are then combined into a unified three-channel representation.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-floods-anomaly" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="./images/ad_china_floods/image8.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;29.8: Accuracy differences between algorithms using original remote sensing data and isolation forest anomaly scores as inputs.</figcaption></figure>
</div>
</div>
</div>
<p>Furthermore, the TSM-SAM method effectively integrates the dual advantages of SAM and TSM, demonstrating outstanding performance in flood extent detection (as shown in <a href="#fig-floods-detection">Figure&nbsp;<span>29.9</span></a>). While the traditional TSM preserves finer flood boundary details, it suffers from insufficient spatial coherence, manifesting as numerous scattered misclassified pixels. In contrast, the deep learning-based SAM model can accurately identify the main flood areas and maintain good spatial continuity, but tends to over-smooth boundary details. This limitation likely stems from SAM's foundation as a general-purpose pre-trained model not specifically optimized for remote sensing data. Moreover, its emphasis on global contextual information during high-level convolutional feature extraction may enhance large-scale semantic understanding at the potential cost of local edge precision. The innovative hybrid architecture of TSM-SAM retains SAM's powerful feature extraction capabilities for complex scenes while inheriting TSM's advantages in edge precision and computational efficiency, ultimately achieving the highest and most stable detection accuracy across all test cases. By combining the semantic understanding of deep learning with the pixel-level accuracy of traditional image processing, this hybrid approach provides a balanced solution that delivers both accuracy and practicality for operational flood monitoring.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-floods-detection" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="./images/ad_china_floods/image9.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;29.9: Comparison of detection result details for crop flooding detection.</figcaption></figure>
</div>
</div>
</div>
</section><section id="conclusions" class="level2" data-number="29.5"><h2 data-number="29.5" class="anchored" data-anchor-id="conclusions">
<span class="header-section-number">29.5</span> Conclusions</h2>
<p>TSM-SAM is an automatic flood extent detection framework combining Isolation Forest, traditional threshold segmentation, and the SAM deep learning model. The test results of three typical flood cases show that TSM-SAM achieves high detection accuracy (average OA = 0.9720, F1 = 0.8870). The Isolation Forest preprocessing enhances feature discriminability and model adaptability by generating optimized input representations. The combined approach significantly outperforms standalone thresholding or SAM-based methods, offering high efficiency and robustness. The TSM-SAM framework demonstrates high potential for efficient, high-accuracy crop flood mapping, supporting rapid agricultural disaster response.</p>
</section><section id="references" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="references">References</h2>
<p>Amitrano, D., Di Martino, G., Di Simone, A., &amp; Imperatore, P. (2024). Flood detection with SAR: A review of techniques and datasets. Remote Sensing, 16(4), 656. https://doi.org/10.3390/rs16040656.</p>
<p>Ball, G. H. (1965). ISODATA, a novel method of data analysis and pattern classification. Stanford Research Institute, AD-699616.</p>
<p>Brown, C. F., Brumby, S. P., Guzder-Williams, B., Birch, T., Hyde, S. B., Mazzariello, J., Czerwinski, W., Pasquarella, V. J., Haertel, R., Ilyushchenko, S., Schwehr, K., Weisse, M., Stolle, F., Hanson, C., Guinan, O., Moore, R., &amp; Tait, A. M. (2022). Dynamic World, Near real-time global 10 m land use land cover mapping. Scientific Data, 9(1), 251. https://doi.org/10.1038/s41597-022-01307-4</p>
<p>DeVries, B., Huang, C., Armston, J., Huang, W., Jones, J. W., &amp; Lang, M. W. (2020). Rapid and robust monitoring of flood events using Sentinel-1 and Landsat data on the Google Earth Engine. Remote Sensing of Environment, 240, 111664. https://doi.org/10.1016/j.rse.2020.111664</p>
<p>Dhal, K. G., Das, A., Ray, S., Gálvez, J., &amp; Das, S. (2020). Nature-inspired optimization algorithms and their application in multi-thresholding image segmentation. Archives of Computational Methods in Engineering, 27(3), 855–888. https://doi.org/10.1007/s11831-019-09334-y</p>
<p>Huang, L. K., &amp; Wang, M.-J. J. (1995). Image thresholding by minimizing the measures of fuzziness. Pattern Recognition, 28(1), 41–51. https://doi.org/10.1016/0031-3203(94)E0043-K</p>
<p>Kapur, J. N., Sahoo, P. K., &amp; Wong, A. K. (1985). A new method for gray-level picture thresholding using the entropy of the histogram. Computer Vision, Graphics, And Image Processing, 29(3), 273–285. https://doi.org/10.1016/0734-189X(85)90125-2</p>
<p>Ke, L., Ye, M., Danelljan, M., Liu, Y., Tai, Y.-W., Tang, C.-K., &amp; Yu, F. (2023). Segment Anything in High Quality. https://arxiv.org/abs/2306.01567</p>
<p>Kittler, J., &amp; Illingworth, J. (1986). Minimum error thresholding. Pattern Recognition, 19(1), 41–47. https://doi.org/10.1016/0031-3203(86)90030-0</p>
<p>Li, C. H., &amp; Lee, C. (1993). Minimum cross entropy thresholding. Pattern Recognition, 26(4), 617–625. https://doi.org/10.1016/0031-3203(93)90115-D</p>
<p>Liu, F., Ting, K., Zhou, Z., &amp; Giannotti, F. (2008). Isolation Forest, 2008 Eighth IEEE International Conference On Data Mining. IEEE, 413-422. https://doi.org/10.1109/ICDM.2008.17</p>
<p>Mullissa, A., Vollrath, A., Odongo-Braun, C., Slagter, B., Balling, J., Gou, Y., Gorelick, N., &amp; Reiche, J. (2021). Sentinel-1 SAR backscatter analysis ready data preparation in google earth engine. Remote Sensing, 13(10). https://doi.org/10.3390/rs13101954O</p>
<p>Tsu, N. &amp; others. (1975). A threshold selection method from gray-level histograms. Automatica, 11(285–296), 23–27. https://doi.org/10.1109/TSMC.1979.4310076</p>
<p>Prewitt, J. M., &amp; Mendelsohn, M. L. (1966). The analysis of cell images. Annals of the New York Academy of Sciences, 128(3), 1035–1053. https://doi.org/10.1111/j.1749-6632.1965.tb11715.x</p>
<p>Ridler, T. W., Calvard, S., &amp; others. (1978). Picture thresholding using an iterative selection method. IEEE Trans. Syst. Man Cybern, 8(8), 630–632. https://doi.org/10.1109/TSMC.1978.4310039</p>
<p>Rosenfeld, A., &amp; De La Torre, P. (1983). Histogram concavity analysis as an aid in threshold selection. IEEE Transactions on Systems, Man, and Cybernetics, SMC-13(2), 231–235. https://doi.org/10.1109/TSMC.1983.6313118</p>
<p>Ta, L., Yu, C., Li, Z., Hu, X., Song, C., Huang, W., &amp; Zhou, M. (2024). Dynamic flood mapping by a normalized probabilistic classification method using satellite radar amplitude time series. Giscience &amp; Remote Sensing, 61(1), 2380125. https://doi.org/10.1080/15481603.2024.2380125</p>
<p>Tsai, W. H. (1985). Moment-preserving thresolding: A new approach. Computer Vision, Graphics, And Image Processing, 29(3), 377–393. https://doi.org/10.1016/0734-189X(85)90133-1</p>
<p>Wang, Z. (2016). Zhenzhou threshold selection. https://www.mathworks.com/matlabcentral/fileexchange/56371-zhenzhou-threshold-selection</p>
<p>Zack, G. W., Rogers, W. E., &amp; Latt, S. A. (1977). Automatic measurement of sister chromatid exchange frequency. Journal of Histochemistry &amp; Cytochemistry, 25(7), 741–753. https://doi.org/10.1177/25.7.70454</p>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./ad_disaster_response.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Remote Sensing for Agricultural Disaster Response</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ad_governance.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Data Governance for Agricultural Statistics</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">Edited by Gilberto Camara, Lorenzo de Simone and Ronald Jansen.</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">This book was built with <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>


</body></html>